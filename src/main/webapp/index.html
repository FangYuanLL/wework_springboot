<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

  <title>Home</title>
  <meta charset="utf-8">
  <meta name="author" content="">
  <meta name="description" content="">
  <meta name="keywords" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css">
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.ico">
  <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,300,500,700,900' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="mystyle.css">


  <script src="js/jquery-1.11.3.min.js"></script>
  <script src="js/modernizr-2.8.3.min.js"></script>

  <script src="js/bootstrap.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.scrollUp.min.js"></script>
  <script src="js/jquery.bxslider.min.js"></script>
  <script src="js/wow.min.js"></script>
  <script src="js/jquery.meanmenu.js"></script>

</head>
<body>
<div class="header-top">
  <div class="container">
    <div class="row">
      <div class="col-md-5 col-sm-6">
        <div class="phone-mail-area">
          <ul>
            <li>
              <a href="#"><i class="fa fa-phone"></i>+86 188-2741-5919</a>
            </li>
            <li>
              <a href="mailto:FangYuan__Liu@126.com"><i class="fa fa-envelope-o"></i>FangYuan__Liu@126.com</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-md-7 col-sm-6">
        <div class="login-bookmark-area">
          <div class="register-login">
            <a href="login.html"><i class="fa fa-user"></i>登录</a>
            <a href="register.html"><i class="fa fa-sign-in"></i>注册</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>
<header class="header-area">
  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <!-- Logo Start -->
        <div class="logo-wrap">
          <a href="#"><img src="images/logo.png" alt=""></a>
        </div>
        <!-- Logo End -->
      </div>
      <div class="col-md-9">
        <!-- Main Menu Start -->
        <div class="main-menu">
          <nav>
            <ul id="nav">
              <li ><a href="http://localhost:8080/index.html">主页</a></li>
              <li><a href="#">搜索房源</a>
                <ul class="sub-menu">
                  <li onclick="cityInformation('北京')"><a href="#">北京</a></li>
                  <li onclick="cityInformation('上海')"><a href="#">上海</a></li>
                  <li onclick="cityInformation('深圳')"><a href="#">深圳</a></li>
                  <li onclick="cityInformation('广州')"><a href="#">广州</a></li>
                  <li onclick="cityInformation('香港')"><a href="#">香港</a></li>
                  <li onclick="cityInformation('成都')"><a href="#">成都</a></li>
                  <li onclick="cityInformation('武汉')"><a href="#">武汉</a></li>
                </ul>
              </li>
              <li><a href="#">办公室类型</a>
                <ul class="sub-menu">
                  <li onclick="TypeInformation('整租')"><a href="#">整租</a></li>
                  <li onclick="TypeInformation('合租')"><a href="#">合租</a></li>
                </ul>
              </li>
              <li><a href="http://localhost:8080/upload.html">业主委托</a></li>
              <li><a onclick="checkUser()">后台管理</a></li>
            </ul>
          </nav>
        </div>
        <!-- Main Menu End -->
      </div>
    </div>
  </div>
</header>

<!-- Slider area Start -->
<section class="properties-area area-pading fix" style="height: 100px">
<div style="text-align: center">
  <form action="#" id="searchForm" style="display: inline-block;">
    <div >
      <select name="Any"  style=" margin: 0;padding: 0; float: left;width: 100px;height: 60px;font-size: 25px" id="Any" onchange="ChangeArea(this.options[this.options.selectedIndex].value)">
        <option value="北京">北京</option>
        <option value="上海">上海</option>
        <option value="深圳">深圳</option>
        <option value="广州">广州</option>
        <option value="重庆">重庆</option>
        <option value="成都">成都</option>
        <option value="杭州">杭州</option>
        <option value="武汉">武汉</option>
      </select>
      <select name="area"  style=" margin: 0;padding: 0; float: left;width: 400px;height: 60px;font-size: 25px" id="area">
      </select>
      <!--<input type="text" id="keyword-input" placeholder="Any" style=" margin: 0;padding: 0; float: left;width: 400px;height: 40px" >-->
      <select name="type"  style=" margin: 0;padding: 0; float: left;width: 100px;height: 60px;font-size: 25px" id="type">
        <option value="整租">整租</option>
        <option value="合租">合租</option>
      </select>
      <input type="submit" value="Search" style="width: 80px;height: 60px;background: dodgerblue;border-color: dodgerblue;font-size: 20px" onclick="getInformation()">
    </div>
  </form>
</div>
</section>
<section class="properties-area area-pading fix">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="properties-title">
          <h2>Featured Properties</h2>
            <!--<a href="#" class="view-more">View More</a>-->
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div id="displaybody" >

    </div>
  </div>
</section>


<!--Footer Top Area Start-->
<section class="footer-top-area  area-pading">
  <div class="container">
    <div class="row">

      <!-- Single Footer Widget-->
      <div class="col-md-3 hidden-sm">
        <div class="single-footer-widget fix">
          <div class="widget-title">
            <h3>搜 索 房 源</h3>
          </div>
          <!--<div class="link-list">-->
            <ul style="font-size: 20px">
              <li><a href="#">北京</a></li>
              <li><a href="#">上海</a></li>
              <li><a href="#">深圳</a></li>
              <li><a href="#">广州</a></li>
              <li><a href="#">重庆</a></li>
              <li><a href="#">成都</a></li>
              <li><a href="#">杭州</a></li>
              <li><a href="#">武汉</a></li>
            </ul>
         <!-- </div>-->
        </div>
      </div>

      <div class="col-md-3 hidden-sm">
        <div class="single-footer-widget fix">
          <div class="widget-title">
            <h3>办 公 类 型</h3>
          </div>
          <ul style="font-size: 20px">
            <li><a href="#">联合办公</a></li>
            <li><a href="#">传统办公</a></li>
          </ul>
        </div>
      </div>

      <div class="col-md-3 col-sm-4">
        <div class="single-footer-widget fix">
          <div class="widget-title">
            <h3> 联 系 我 们</h3>
          </div>
        </div>

        <div class="address-wrap">
          <i class="fa fa-phone"></i>
          <div class="address-text">
            <h4>电话：</h4>
            <p>+ 188 2741 5919</p>
          </div>
        </div>
        <div class="address-wrap">
          <i class="fa fa-envelope"></i>
          <div class="address-text">
            <h4>邮箱：</h4>
            <p>Fangyuan__Liu@126.com</p>
          </div>
        </div>
      </div>
      <!-- Single Footer Widget End-->
      <div class="col-md-3 col-sm-4">
        <div class="single-footer-widget fix agents-widget">
          <div class="widget-title">
            <h3> 关 于 我 们</h3>
          </div>
        </div>
      </div>

    </div>
  </div>
</section>

<script src="js/script.js"></script>
<!--搜狐IP地址查询接口，直接调用接口获取ip就可以定位到你此时的城市-->
<script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
</body>
<script>
    /*-----------利用ip获取定位-----------*/
    var cityName = returnCitySN.cname;
    alert(cityName);
    //var city;
    var LocationLength;
    for (var i = 0; i < cityName.length; i++) {
        if (cityName[i] == "省")
        {
            LocationLength = i;
        }
    }
    var obj;
    if(LocationLength >= cityName.length-1){
        obj = cityName;
    }else{
        obj = cityName.substring(LocationLength+1,cityName.length-1);
    }
    alert(obj);
    /*------------------end---------------*/

    var AreaData = new Array();
    AreaData[0] = ["东城区","西城区","朝阳区","丰台区","石景山区","海淀区","顺义区","通州区","大兴区","房山区","门头沟区","昌平区","平谷区","密云区","怀柔区","延庆区"];
    AreaData[1] = ["浦东新区","徐汇区","长宁区","普陀区","闸北区","虹口区","杨浦区","黄浦区","卢湾区","静安区","宝山区","闵行区","嘉定区","金山区","松江区","青浦区","奉贤区","南汇区"];
    AreaData[2] = ["罗湖区","福田区","南山区","盐田区","龙岗区","宝安区","光明新区","坪山新区"];
    AreaData[3] = ["荔湾区","越秀区","海珠区","天河区","白云区","黄埔区","番禺区","花都区","萝岗区","南沙区","增城区","从化区"];
    AreaData[4] = ["万州区","黔江区","涪陵区","渝中区","大渡口区","江北区","沙坪坝区","九龙坡区","南岸区","北碚区","渝北区","巴南区","长寿区","江津区","合川区","永川区","南川区","大足区","铜梁区","璧山区"];
    AreaData[5] = ["武侯区","锦江区","青羊区","金牛区","成华区","龙泉驿区","温江区","新都区","青白江区","双流区","郫都区"];
    AreaData[6] = ["西湖区","上城区","下城区","江干区","拱墅区","滨江区","富阳区","萧山区","余杭区"];
    AreaData[7] = ["武昌区","青山区","洪山区","江岸区","江汉区","桥口区","汉阳区"];
    var AreaDataVAlue = "";
    $(document).ready(function() {
        var area;

        /*------------设置下拉框的默认值-----------*/
        var options = document.getElementById("Any").options;
        for(var t= 0; t < options.length;t++){
            if (options[t].value == obj){
                options[t].selected = true;
                area = t;
                //设置级联下拉框的值
                //alert(AreaData[t].length);
                for (var y = 0; y < AreaData[t].length ;y++)
                {
                    AreaDataVAlue += "<option value='"+AreaData[t][y]+"'>"+AreaData[t][y]+"</option>";
                }
                $("#area").append(AreaDataVAlue);
            }
        }

        /*------------结束----------------------*/
        if(AreaData[area]){
            var InitArea = AreaData[area][0];
        }

        /*获取类型type的选中值*/
        var text1 = document.getElementById("type");
        var index1 = text1.selectedIndex;
        var textvalue1 = text1.options[index1].value;
        /*InitArea未用到，textvalue1*/
      //  {city:obj}
        $.ajax({
            url : "/house/getHouseInformation",//请求地址
            dataType : 'json',//数据格式
            type : "post",//请求方式
            data :"",//数据请求发送，从searchform中提取数据
            async : false,//是否异步请求
            success : function(msg) {
                    if (msg.status == 1) {
                        var data = eval(msg.list);
                        var ImageName = eval(msg.listImage);
                        $("#displaybody").empty();
                        var count = 0;
                        var value="";
                        $.each(data, function (num) {
                            value = "<div class='col-md-4 col-sm-6' style='margin-top: 15px'><div class='single-featured-properties'><div class='properties-image'>"
                            +"<a href='#'><img src='images/houseImages/"+ImageName[num]+"' width='2000' height='1000'></a></div><div class='sale-tag'><p>For Rent</p></div>"
                            +"<div class='properties-content'><h3><a href='#'>"+data[num].empty+"</a></h3><p><i class='fa fa-map-marker'></i>"+data[num].city+"  "+data[num].area+"</p>"
                            +"<div class='price-detail'><p class='price-range pull-left'>$"+data[num].price+"</p><a href='javascript:void(0)' onclick='tranforID("+data[num].id+")' class='price-detail pull-right'>预定<i class='fa fa-angle-right'></i></a>"
                            +"</div></div></div>";

                            $("#displaybody").append(value);
                        })

                        //value="";
                    }
                    /*跳转到登录页面,重新登录*/
                    /*window.location.href="";*/
            },
        })


    })

  function tranforID(id){
      $.ajax({
          url: "/house/houseID",
          type: "post",
          dataType : "json",
          data: {"id":id},
          async : false,
          success:function(data){
              if(data.status==1){
                  window.location.href="details.html";
                  /*跳转到该房源的详情页面details.html*/
              }else if (data.status == -3) {
                  alert("请先登录！");
                  window.location.href = "login.html";
              }else{
                  alert("tranforID is error!");
              }
          }
      })
  }

  //级联下拉框的方法
  function ChangeArea(obj){
      alert(123);
      //var  = document.getElementsById("Any").value;
      alert(obj);
      var data ="";
      var options = document.getElementById("Any").options;
      for(var t= 0; t < options.length;t++){
          if (options[t].value == obj){
              //alert(options[t].value);
              options[t].selected = true;
              //设置级联下拉框的值
              for (var y = 0; y < AreaData[t].length ;y++)
              {
                  data += "<option value='"+AreaData[t][y]+"'>"+AreaData[t][y]+"</option>";
              }
             document.getElementById("area").options.length = 0;//将下拉框清空
              $("#area").append(data);//填充新的数据
          }
      }
  }

  function getInformation(){
        alert(3322);
      /*获取city的选中值*/
      var text0 = document.getElementById("city");
      var index0 = text.selectedIndex;
      var textvalue0 = text.options[index0].value;

      /*获取id=area的选中值*/
      var text = document.getElementById("area");
      var index = text.selectedIndex;
      var textvalue = text.options[index1].value;

      /*获取类型type的选中值*/
      var text1 = document.getElementById("type");
      var index1 = text.selectedIndex;
      var textvalue1 = text.options[index2].value;

      var value ="";
      $.ajax({
          url : "/house/getHouseInformation",//请求地址
          dataType : 'json',//数据格式
          type : "post",//请求方式
          data :{city:textvalue0,area:textvalue,officetype:textvalue1},//数据请求发送，从searchform中提取数据
          async : false,//是否异步请求
          success : function(msg) {
              if (msg.status == 1) {
                  var data = eval(msg.list);
                  var ImageName = eval(msg.listImage);
                  $("#displaybody").empty();
                  var count = 0;
                  var value="";
                  $.each(data, function (num) {
                      value = "<div class='col-md-4 col-sm-6' style='margin-top: 15px'><div class='single-featured-properties'><div class='properties-image'>"
                          +"<a href='#'><img src='images/houseImages/"+ImageName[num]+"' alt=''></a></div><div class='sale-tag'><p>For Rent</p></div>"
                          +"<div class='properties-content'><h3><a href='#'>"+data[num].empty+"</a></h3><p><i class='fa fa-map-marker'></i>"+data[num].city+"  "+data[num].area+"</p>"
                          +"<div class='price-detail'><p class='price-range pull-left'>$"+data[num].price+"</p><a href='javascript:void(0)' onclick='tranforID("+data[num].id+")' class='price-detail pull-right'>预定<i class='fa fa-angle-right'></i></a>"
                          +"</div></div></div>";

                      $("#displaybody").append(value);
                  })

                  //value="";
              }
              /*跳转到登录页面,重新登录*/
              /*window.location.href="";*/
          },
      })
  }

    function cityInformation(value){
        alert(value);
        $.ajax({
            url : "/house/getHouseInformation",//请求地址
            dataType : 'json',//数据格式
            type : "post",//请求方式
            data :{city:value},//数据请求发送，从searchform中提取数据
            async : false,//是否异步请求
            success : function(msg) {
                if (msg.status == 1) {
                    var data = eval(msg.list);
                    var ImageName = eval(msg.listImage);
                    /*清空之前append的内容*/
                    $("#displaybody").empty();
                    var count = 0;
                    var value="";
                    $.each(data, function (num) {
                        value = "<div class='col-md-4 col-sm-6' style='margin-top: 15px'><div class='single-featured-properties'><div class='properties-image'>"
                            +"<a href='#'><img src='images/houseImages/"+ImageName[num]+"' alt=''></a></div><div class='sale-tag'><p>For Rent</p></div>"
                            +"<div class='properties-content'><h3><a href='#'>"+data[num].empty+"</a></h3><p><i class='fa fa-map-marker'></i>"+data[num].city+"  "+data[num].area+"</p>"
                            +"<div class='price-detail'><p class='price-range pull-left'>$"+data[num].price+"</p><a href='javascript:void(0)' onclick='tranforID("+data[num].id+")' class='price-detail pull-right'>预定<i class='fa fa-angle-right'></i></a>"
                            +"</div></div></div>";

                        $("#displaybody").append(value);
                    })

                    //value="";
                }
                /*跳转到登录页面,重新登录*/
                /*window.location.href="";*/
            },
        })
    }

    function TypeInformation(value){
        alert(value);
        $.ajax({
            url : "/house/getHouseInformation",//请求地址
            dataType : 'json',//数据格式
            type : "post",//请求方式
            data :{officetype:value},//数据请求发送，从searchform中提取数据
            async : false,//是否异步请求
            success : function(msg) {
                if (msg.status == 1) {
                    var data = eval(msg.list);
                    var ImageName = eval(msg.listImage);
                    /*清空之前append的内容*/
                    $("#displaybody").empty();
                    var count = 0;
                    var value="";
                    $.each(data, function (num) {
                        value = "<div class='col-md-4 col-sm-6' style='margin-top: 15px'><div class='single-featured-properties'><div class='properties-image'>"
                            +"<a href='#'><img src='images/houseImages/"+ImageName[num]+"' alt=''></a></div><div class='sale-tag'><p>For Rent</p></div>"
                            +"<div class='properties-content'><h3><a href='#'>"+data[num].empty+"</a></h3><p><i class='fa fa-map-marker'></i>"+data[num].city+"  "+data[num].area+"</p>"
                            +"<div class='price-detail'><p class='price-range pull-left'>$"+data[num].price+"</p><a href='javascript:void(0)' onclick='tranforID("+data[num].id+")' class='price-detail pull-right'>预定<i class='fa fa-angle-right'></i></a>"
                            +"</div></div></div>";

                        $("#displaybody").append(value);
                    })

                    //value="";
                }
                /*跳转到登录页面,重新登录*/
                /*window.location.href="";*/
            },
        })
    }
</script>
<script>
  function checkUser(){
      $.ajax({
          url: "/User/CurrentUser",
          dataType: 'json',
          type: "post",
          data: "",
          async: false,
          success: function (msg) {
              if (msg.status == 1){
                  window.location.href = "userManage.html";
              }else{
                  window.location.href = "administrator.html";
              }
          }
      })
  }
</script>
</html>


